rule malware
//should only trigger file4 but not any of the files in the .zip provided in myCourses
{
	meta: 
		Date: "2025-04-24"
		Description = "YARA rules for the provided file given in myCourses"
		
	strings: 
		$mz = "A5 D4" //the file's magic number
		
		$assem = "<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"><trustInfo xmlns="urn:schemas-microsoft-com:asm.v3"><security><requestedPrivileges><requestedExecutionLevel level="asInvoker" uiAccess="false"></requestedExecutionLevel></requestedPrivileges></security></trustInfo><compatibility xmlns="urn:schemas-microsoft-com:compatibility.v1"><application><supportedOS Id="{e2011457-1546-43c5-a5fe-008deee3d3f0}"></supportedOS><supportedOS Id="{35138b9a-5d96-4fbd-8e2d-a2440225f93a}"></supportedOS><supportedOS Id="{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}"></supportedOS><supportedOS Id="{1f676c76-80e1-4239-95bb-83d0f6d0da78}"></supportedOS><supportedOS Id="{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}"></supportedOS></application></compatibility></assembly>" //goofy ahh assembly string I found
		
		$name = "Thunderbird"
		
	condition: 
		$mz //the magic number must be in the file
		
		filesize == 202KB //this file is the only one that is 202KB (considered file metadata)
		
		$assem //string matching
		
		#name >= 2
}
